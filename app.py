import streamlit as st
import pandas as pd

st.set_page_config(layout="wide")

st.title("üêû M√≥dulo de Depuraci√≥n de Datos")
st.header("Por favor, carga tu archivo Excel para analizar su estructura.")

# --- Configuraci√≥n de Nombres de Columnas (SOLO PARA REFERENCIA, no se usa a√∫n) ---
# Aqu√≠ est√°n los nombres que HEMOS INTENTADO USAR:
# VOLUME_COLUMN = 'TONELAJE'
# EMPRESA_COLUMN = 'EMPRESA DE TRANSPORTE'  # Tambi√©n hemos probado 'L' y 'PATENTE'
# FECHA_COLUMN = 'FECHA'
# PRODUCTO_COLUMN = 'PRODUCTO'
# DESTINO_COLUMN = 'DESTINO'

# --- Carga de Datos ---
uploaded_file = st.sidebar.file_uploader(
    "Carga tu archivo Excel para diagn√≥stico (.xlsx)",
    type=["xlsx"]
)

if uploaded_file is not None:
    st.success("‚úÖ **Archivo cargado!** Procediendo a analizarlo...")

    try:
        df = pd.read_excel(uploaded_file)
        st.success("‚úÖ **Pandas ley√≥ el archivo Excel exitosamente!**")
        st.balloons() # Peque√±a celebraci√≥n

        # --- AN√ÅLISIS DE ESTRUCTURA ---
        st.subheader("1. Nombres de Columnas Detectados")
        st.info("Esta es la lista de los nombres de columnas EXACTOS que Pandas encontr√≥ en tu archivo. ¬°Esta es la informaci√≥n m√°s importante!")
        
        columnas_detectadas = df.columns.tolist()
        st.code(columnas_detectadas) # Muestra las columnas en un formato de c√≥digo para copiar f√°cil

        st.subheader("2. Informaci√≥n General del DataFrame")
        st.text("Aqu√≠ vemos los tipos de datos que Pandas asign√≥ a cada columna.")
        st.code(str(df.info(verbose=True, show_counts=True)))

        st.subheader("3. Primeras 10 Filas del Archivo Cargado")
        st.info("As√≠ es como se ven las primeras 10 filas de tus datos despu√©s de cargarlos.")
        st.dataframe(df.head(10))

    except Exception as e:
        st.error(f"‚ùå **Ocurri√≥ un error al intentar leer o procesar el archivo Excel.**")
        st.exception(e) # Muestra el traceback completo del error

else:
    st.info("Esperando que cargues un archivo Excel para poder analizarlo...")